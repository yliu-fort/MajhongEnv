#:kivy 2.1.0

<ActionOverlay>:
    message_label: message_label
    button_container: button_container
    size_hint: 1, 1
    pos: 0, 0
    visible: False
    canvas.before:
        Color:
            rgba: (0, 0, 0, 0.65) if self.visible else (0, 0, 0, 0)
        Rectangle:
            size: self.size
            pos: self.pos
    BoxLayout:
        size_hint: 0.8, None
        height: min(root.height * 0.8, max(self.minimum_height, 200))
        pos_hint: {"center_x": 0.5, "center_y": 0.5}
        orientation: "vertical"
        spacing: 12
        padding: 16
        canvas.before:
            Color:
                rgba: 12/255.0, 30/255.0, 60/255.0, 0.95
            RoundedRectangle:
                pos: self.pos
                size: self.size
                radius: [12, 12, 12, 12]
        Label:
            id: message_label
            text: root.message
            size_hint_y: None
            height: max(32, self.texture_size[1])
            color: 235/255.0, 235/255.0, 235/255.0, 1
        ScrollView:
            size_hint: 1, 1
            do_scroll_x: False
            bar_width: 8
            effect_cls: 'ScrollEffect'
            GridLayout:
                id: button_container
                cols: 2
                size_hint_y: None
                height: self.minimum_height
                row_default_height: 48
                row_force_default: True
                spacing: 8

<MahjongRoot>:
    board: board
    status_label: status_label
    reward_label: reward_label
    done_label: done_label
    pause_button: pause_button
    auto_button: auto_button
    step_button: step_button
    language_spinner: language_spinner
    canvas.before:
        Color:
            rgba: 12/255.0, 30/255.0, 60/255.0, 1
        Rectangle:
            size: self.size
            pos: self.pos
    MahjongBoardWidget:
        id: board
        size_hint: None, None
        width: min(root.width, root.height)
        height: min(root.width, root.height)
        pos: (root.center_x - self.width / 2, root.center_y - self.height / 2)
    Label:
        id: status_label
        text: ""
        halign: 'left'
        valign: 'top'
        text_size: self.width, None
        size_hint: None, None
        size: max(240, self.texture_size[0]), self.texture_size[1]
        pos: 16, root.height - self.height - 16
        color: 170/255.0, 190/255.0, 210/255.0, 1
    Label:
        id: reward_label
        text: ""
        halign: 'right'
        valign: 'top'
        text_size: None, None
        size_hint: None, None
        size: self.texture_size
        pos: root.width - self.width - 16, root.height - self.height - 16
        color: 235/255.0, 235/255.0, 235/255.0, 1
    Label:
        id: done_label
        text: ""
        halign: 'right'
        valign: 'top'
        text_size: None, None
        size_hint: None, None
        size: self.texture_size
        pos: root.width - self.width - 16, reward_label.y - self.height - 4
        color: 220/255.0, 120/255.0, 120/255.0, 1
    Button:
        id: step_button
        text: ""
        size_hint: None, None
        size: 160, 44
        pos: root.width - self.width - 16, 16
        background_normal: ''
        background_color: 5/255.0, 5/255.0, 5/255.0, 1
    Button:
        id: auto_button
        text: ""
        size_hint: None, None
        size: 160, 44
        pos: step_button.x, step_button.top + 10
        background_normal: ''
        background_color: 5/255.0, 5/255.0, 5/255.0, 1
    Button:
        id: pause_button
        text: ""
        size_hint: None, None
        size: 160, 44
        pos: auto_button.x, auto_button.top + 10
        background_normal: ''
        background_color: 5/255.0, 5/255.0, 5/255.0, 1
    Spinner:
        id: language_spinner
        text: ""
        values: ()
        size_hint: None, None
        size: 160, 44
        pos: pause_button.x, pause_button.top + 10
        background_normal: ''
        background_color: 5/255.0, 5/255.0, 5/255.0, 1
        color: 235/255.0, 235/255.0, 235/255.0, 1
    ActionOverlay:
        id: action_overlay

<MahjongBoardWidget>:
    canvas.before:
        Color:
            rgba: 24/255.0, 60/255.0, 90/255.0, 1
        RoundedRectangle:
            size: self.size
            pos: self.pos
            radius: [16, 16, 16, 16]
    canvas.after:
        Color:
            rgba: 40/255.0, 90/255.0, 130/255.0, 1
        Line:
            rounded_rectangle: (*self.pos, *self.size, 16)
            width: 3

